<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HubSpot Formular Test</title>
</head>
<body>
  <h1>Formular-Test-Bildungsprodukt</h1>
  
  <!-- Hier wird das Formular erscheinen -->
  <div id="form-container"></div>
  
  <!-- Original HubSpot Embedding-Code -->
  <script charset="utf-8" type="text/javascript" src="//js-eu1.hsforms.net/forms/embed/v2.js"></script>
  <script>
    // URL-Slug extrahieren (vor dem Laden des Formulars)
    const path = window.location.pathname;
    const slug = path.split('/').filter(Boolean).pop() || 'test-slug';
    console.log("Extrahierter Slug:", slug);
    
    // Beim Laden der Seite
    document.addEventListener('DOMContentLoaded', function() {
      hbspt.forms.create({
        region: "eu1",
        portalId: "26459032",
        formId: "c744833f-5a18-42bb-bcef-849296aa33b0",
        target: "#form-container",
        
        onFormReady: function($form) {
          console.log("Formular wurde geladen");
          
          // Nach einer kurzen Pause versuchen, das Feld zu finden und zu befüllen
          setTimeout(function() {
            console.log("Versuche, das Feld 'kurs_slug' zu finden...");
            
            // Bei normalen Feldern, alle Eingabefelder durchsuchen
            const allInputs = $form.find('input, select, textarea');
            console.log("Alle Eingabefelder im Formular:", allInputs.length);
            
            // DEBUG: Alle Eingabefelder auflisten
            allInputs.each(function() {
              console.log("Feld gefunden:", $(this).attr('name'), "Typ:", $(this).attr('type'));
            });
            
            // Versuche, das Feld zu finden und zu befüllen
            const field = $form.find('input[name="kurs_slug"]');
            if (field.length) {
              field.val(slug);
              console.log("Feld 'kurs_slug' gefunden und mit Wert befüllt:", slug);
            } else {
              // Alternativ können wir nach Labels suchen
              $form.find('label').each(function() {
                const labelText = $(this).text().toLowerCase();
                if (labelText.includes('kurs') || labelText.includes('slug')) {
                  const inputId = $(this).attr('for');
                  if (inputId) {
                    const input = $form.find('#' + inputId);
                    if (input.length) {
                      input.val(slug);
                      console.log("Feld über Label gefunden und befüllt:", labelText);
                    }
                  }
                }
              });
              
              console.log("Hinweis: Konnte kein Feld mit dem Namen 'kurs_slug' finden");
            }
          }, 1000);
        }
      });
    });
  </script>
</body>
</html>
